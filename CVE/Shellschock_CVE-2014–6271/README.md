# Shellshock - CVE-2014-6271
Link to the [CVE](https://nvd.nist.gov/vuln/detail/cve-2014-6271)

Vulnerability found in Bash versions 1.03 through 4.3 that allows attackers to execute arbitrary commands.

## How it works
Shellshock arises from Bashâ€™s incorrect processing of commands following function definitions in environment variables, potentially exploited when user input is stored in these variables.

Bash allows defining functions within environment variables, a feature useful for passing functions to subprocesses. The vulnerability arises because Bash continues to interpret and execute commands appended after the function definition, enabling arbitrary code execution.

Example:

    export MYFUNC='() { :; }; echo "Vulnerable"'
    bash -c 'echo Test'

After invoking the second line, if the bash version is vulnerable, you'll se as output:
`Vulnerable Test`.
Bash interprets `MYFUNC` as a function but also executes the appended command (`echo "Vulnerable"`). If an attacker controls the input, they can inject malicious commands.

## Attack Vectors
ShellShock can be exploited in various contexts where Bash is used to run scripts, such as:
- **Web servers**: A server using CGI to handle HTTP requests may be vulnerable if it uses Bash to execute scripts. An attacker could inject malicious payloads in HTTP headers, such as User-Agent, Referer, or Cookie.
- **SSH**: Users with SSH access and the ability to define environment variables can exploit ShellShock.
- **Network services**: Any service that passes input to Bash for processing can be vulnerable.

### Web servers example
When a client sends an HTTP request to the web server, the server can invoke a CGI script to process the request. So the CGI script handles the request by doing other operations.

An attacker can craft a specially HTTP request containing malicious data in HTTP headers such as User-Agent, Referer, or Cookie. When the web server processes this request, it passes these headers to a CGI script that invokes Bash, which is vulnerable to ShellShock, and executes the attacker's command.

Example vulnerable cgi script that takes the input query (QUERY_STRING) from the URL and executes it:

    #!/bin/bash
    echo "Content-type: text/plain"
    echo ""
    echo "Executed command: $QUERY_STRING"

The attacker crafts an HTTP request to send to the server that includes a payload in one of the HTTP headers:
`curl -H "User-Agent: () { :; }; /bin/bash -c 'echo Vulnerable'" http://target-server/cgi-bin/vulnerable.cgi?query=test`

- `() { :; };` defines a function in the User-Agent header.
- `/bin/bash -c '...'` runs a Bash command, which echos Vulnerable

## Setting up the VM

